From 1889f13fde46f766a8770ddcb69daf5e37d19b73 Mon Sep 17 00:00:00 2001
From: Stefan Berger <stefanb@linux.ibm.com>
Date: Thu, 6 Jan 2022 14:19:39 -0500
Subject: [PATCH 67/87] ima: Allow appraisal policy rules in IMA namespaces

Allow appraisal policy rules in IMA namespaces now.

Signed-off-by: Stefan Berger <stefanb@linux.ibm.com>
---
 security/integrity/ima/ima_policy.c | 3 +--
 1 file changed, 1 insertion(+), 2 deletions(-)

diff --git a/security/integrity/ima/ima_policy.c b/security/integrity/ima/ima_policy.c
index 4b4b3061a8f0..4ea60ebbd699 100644
--- a/security/integrity/ima/ima_policy.c
+++ b/security/integrity/ima/ima_policy.c
@@ -1943,10 +1943,9 @@ static int ima_parse_rule(struct user_namespace *user_ns,
 			break;
 		}
 
-		/* IMA namespace only accepts AUDIT & MEASURE rules */
+		/* IMA namespace only rejects HASH rules */
 		if (ns != &init_ima_ns && result == 0) {
 			switch (entry->action) {
-			case APPRAISE:
 			case HASH:
 				result = -EINVAL;
 				goto err_audit;
-- 
2.37.3

